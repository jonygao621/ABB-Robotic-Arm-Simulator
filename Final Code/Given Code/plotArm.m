function axisHandel = plotArm(th_list, Sim_Exact, axisHandel)
th1 = th_list(1);
th2 = th_list(2)-pi/2; %% change from abb to dh
th3 = th_list(3);
th4 = th_list(4);
th5 = th_list(5);
th6 = th_list(6);

if(Sim_Exact)
    
    T06 = [ sin(th6)*(cos(th4)*sin(th1) + sin(th4)*(cos(th1)*sin(th2)*sin(th3) - cos(th1)*cos(th2)*cos(th3))) + cos(th6)*(cos(th5)*(sin(th1)*sin(th4) - cos(th4)*(cos(th1)*sin(th2)*sin(th3) - cos(th1)*cos(th2)*cos(th3))) - sin(th5)*(cos(th1)*cos(th2)*sin(th3) + cos(th1)*cos(th3)*sin(th2))), cos(th6)*(cos(th4)*sin(th1) + sin(th4)*(cos(th1)*sin(th2)*sin(th3) - cos(th1)*cos(th2)*cos(th3))) - sin(th6)*(cos(th5)*(sin(th1)*sin(th4) - cos(th4)*(cos(th1)*sin(th2)*sin(th3) - cos(th1)*cos(th2)*cos(th3))) - sin(th5)*(cos(th1)*cos(th2)*sin(th3) + cos(th1)*cos(th3)*sin(th2))), - sin(th5)*(sin(th1)*sin(th4) - cos(th4)*(cos(th1)*sin(th2)*sin(th3) - cos(th1)*cos(th2)*cos(th3))) - cos(th5)*(cos(th1)*cos(th2)*sin(th3) + cos(th1)*cos(th3)*sin(th2)), (27*cos(th1)*cos(th2))/100 - (9*sin(th5)*(sin(th1)*sin(th4) - cos(th4)*(cos(th1)*sin(th2)*sin(th3) - cos(th1)*cos(th2)*cos(th3))))/125 - (9*cos(th5)*(cos(th1)*cos(th2)*sin(th3) + cos(th1)*cos(th3)*sin(th2)))/125 - (7*cos(th1)*sin(th2)*sin(th3))/100 + (7*cos(th1)*cos(th2)*cos(th3))/100 - (151*cos(th1)*cos(th2)*sin(th3))/500 - (151*cos(th1)*cos(th3)*sin(th2))/500;
        - sin(th6)*(cos(th1)*cos(th4) - sin(th4)*(sin(th1)*sin(th2)*sin(th3) - cos(th2)*cos(th3)*sin(th1))) - cos(th6)*(cos(th5)*(cos(th1)*sin(th4) + cos(th4)*(sin(th1)*sin(th2)*sin(th3) - cos(th2)*cos(th3)*sin(th1))) + sin(th5)*(cos(th2)*sin(th1)*sin(th3) + cos(th3)*sin(th1)*sin(th2))), sin(th6)*(cos(th5)*(cos(th1)*sin(th4) + cos(th4)*(sin(th1)*sin(th2)*sin(th3) - cos(th2)*cos(th3)*sin(th1))) + sin(th5)*(cos(th2)*sin(th1)*sin(th3) + cos(th3)*sin(th1)*sin(th2))) - cos(th6)*(cos(th1)*cos(th4) - sin(th4)*(sin(th1)*sin(th2)*sin(th3) - cos(th2)*cos(th3)*sin(th1))), sin(th5)*(cos(th1)*sin(th4) + cos(th4)*(sin(th1)*sin(th2)*sin(th3) - cos(th2)*cos(th3)*sin(th1))) - cos(th5)*(cos(th2)*sin(th1)*sin(th3) + cos(th3)*sin(th1)*sin(th2)), (27*cos(th2)*sin(th1))/100 + (9*sin(th5)*(cos(th1)*sin(th4) + cos(th4)*(sin(th1)*sin(th2)*sin(th3) - cos(th2)*cos(th3)*sin(th1))))/125 - (9*cos(th5)*(cos(th2)*sin(th1)*sin(th3) + cos(th3)*sin(th1)*sin(th2)))/125 - (151*cos(th2)*sin(th1)*sin(th3))/500 - (151*cos(th3)*sin(th1)*sin(th2))/500 - (7*sin(th1)*sin(th2)*sin(th3))/100 + (7*cos(th2)*cos(th3)*sin(th1))/100;
        sin(th4)*sin(th6)*(cos(th2)*sin(th3) + cos(th3)*sin(th2)) - cos(th6)*(sin(th5)*(cos(th2)*cos(th3) - sin(th2)*sin(th3)) + cos(th4)*cos(th5)*(cos(th2)*sin(th3) + cos(th3)*sin(th2))), sin(th6)*(sin(th5)*(cos(th2)*cos(th3) - sin(th2)*sin(th3)) + cos(th4)*cos(th5)*(cos(th2)*sin(th3) + cos(th3)*sin(th2))) + cos(th6)*sin(th4)*(cos(th2)*sin(th3) + cos(th3)*sin(th2)), cos(th4)*sin(th5)*(cos(th2)*sin(th3) + cos(th3)*sin(th2)) - cos(th5)*(cos(th2)*cos(th3) - sin(th2)*sin(th3)), (151*sin(th2)*sin(th3))/500 - (151*cos(th2)*cos(th3))/500 - (7*cos(th2)*sin(th3))/100 - (7*cos(th3)*sin(th2))/100 - (27*sin(th2))/100 - (9*cos(th5)*(cos(th2)*cos(th3) - sin(th2)*sin(th3)))/125 + (9*cos(th4)*sin(th5)*(cos(th2)*sin(th3) + cos(th3)*sin(th2)))/125 + 29/100;
        0, 0, 0, 1];
    
    P1 =[ 0
        0
        0.29];
    P2 = [ 0.27*cos(th1)*cos(th2);
        0.27*cos(th2)*sin(th1);
        0.29 - 0.27*sin(th2)];
    P3 = [ 0.27*cos(th1)*cos(th2) - 0.07*cos(th1)*sin(th2)*sin(th3) + 0.07*cos(th1)*cos(th2)*cos(th3);
        0.27*cos(th2)*sin(th1) - 0.07*sin(th1)*sin(th2)*sin(th3) + 0.07*cos(th2)*cos(th3)*sin(th1);
        0.29 - 0.07*cos(th2)*sin(th3) - 0.07*cos(th3)*sin(th2) - 0.27*sin(th2)];
    
    P4 = [ 0.27*cos(th1)*cos(th2) - 0.07*cos(th1)*sin(th2)*sin(th3) + 0.07*cos(th1)*cos(th2)*cos(th3) - 0.302*cos(th1)*cos(th2)*sin(th3) - 0.302*cos(th1)*cos(th3)*sin(th2);
        0.27*cos(th2)*sin(th1) - 0.302*cos(th2)*sin(th1)*sin(th3) - 0.302*cos(th3)*sin(th1)*sin(th2) - 0.07*sin(th1)*sin(th2)*sin(th3) + 0.07*cos(th2)*cos(th3)*sin(th1);
        0.302*sin(th2)*sin(th3) - 0.302*cos(th2)*cos(th3) - 0.07*cos(th2)*sin(th3) - 0.07*cos(th3)*sin(th2) - 0.27*sin(th2) + 0.29];
    P5 = [ 0.27*cos(th1)*cos(th2) - 0.07*cos(th1)*sin(th2)*sin(th3) + 0.07*cos(th1)*cos(th2)*cos(th3) - 0.302*cos(th1)*cos(th2)*sin(th3) - 0.302*cos(th1)*cos(th3)*sin(th2)
        0.27*cos(th2)*sin(th1) - 0.302*cos(th2)*sin(th1)*sin(th3) - 0.302*cos(th3)*sin(th1)*sin(th2) - 0.07*sin(th1)*sin(th2)*sin(th3) + 0.07*cos(th2)*cos(th3)*sin(th1)
        0.302*sin(th2)*sin(th3) - 0.302*cos(th2)*cos(th3) - 0.07*cos(th2)*sin(th3) - 0.07*cos(th3)*sin(th2) - 0.27*sin(th2) + 0.29];
    
    P6 =[ 0.27*cos(th1)*cos(th2) - 0.07*cos(th1)*sin(th2)*sin(th3) - 0.072*sin(th1)*sin(th4)*sin(th5) + 0.07*cos(th1)*cos(th2)*cos(th3) - 0.302*cos(th1)*cos(th2)*sin(th3) - 0.302*cos(th1)*cos(th3)*sin(th2) - 0.072*cos(th1)*cos(th2)*cos(th5)*sin(th3) - 0.072*cos(th1)*cos(th3)*cos(th5)*sin(th2) - 0.072*cos(th1)*cos(th2)*cos(th3)*cos(th4)*sin(th5) + 0.072*cos(th1)*cos(th4)*sin(th2)*sin(th3)*sin(th5);
        0.27*cos(th2)*sin(th1) - 0.302*cos(th2)*sin(th1)*sin(th3) - 0.302*cos(th3)*sin(th1)*sin(th2) + 0.072*cos(th1)*sin(th4)*sin(th5) - 0.07*sin(th1)*sin(th2)*sin(th3) + 0.07*cos(th2)*cos(th3)*sin(th1) - 0.072*cos(th2)*cos(th5)*sin(th1)*sin(th3) - 0.072*cos(th3)*cos(th5)*sin(th1)*sin(th2) - 0.072*cos(th2)*cos(th3)*cos(th4)*sin(th1)*sin(th5) + 0.072*cos(th4)*sin(th1)*sin(th2)*sin(th3)*sin(th5);
        0.302*sin(th2)*sin(th3) - 0.302*cos(th2)*cos(th3) - 0.07*cos(th2)*sin(th3) - 0.07*cos(th3)*sin(th2) - 0.27*sin(th2) + 0.072*cos(th5)*sin(th2)*sin(th3) - 0.072*cos(th2)*cos(th3)*cos(th5) + 0.072*cos(th2)*cos(th4)*sin(th3)*sin(th5) + 0.072*cos(th3)*cos(th4)*sin(th2)*sin(th5) + 0.29];
    
else
    
    T06 = [ sin(th6)*(cos(th4)*sin(th1) + sin(th4)*(cos(th1)*sin(th2)*sin(th3) - cos(th1)*cos(th2)*cos(th3))) + cos(th6)*(cos(th5)*(sin(th1)*sin(th4) - cos(th4)*(cos(th1)*sin(th2)*sin(th3) - cos(th1)*cos(th2)*cos(th3))) - sin(th5)*(cos(th1)*cos(th2)*sin(th3) + cos(th1)*cos(th3)*sin(th2))), cos(th6)*(cos(th4)*sin(th1) + sin(th4)*(cos(th1)*sin(th2)*sin(th3) - cos(th1)*cos(th2)*cos(th3))) - sin(th6)*(cos(th5)*(sin(th1)*sin(th4) - cos(th4)*(cos(th1)*sin(th2)*sin(th3) - cos(th1)*cos(th2)*cos(th3))) - sin(th5)*(cos(th1)*cos(th2)*sin(th3) + cos(th1)*cos(th3)*sin(th2))), - sin(th5)*(sin(th1)*sin(th4) - cos(th4)*(cos(th1)*sin(th2)*sin(th3) - cos(th1)*cos(th2)*cos(th3))) - cos(th5)*(cos(th1)*cos(th2)*sin(th3) + cos(th1)*cos(th3)*sin(th2)), (151838081588107*cos(th1)*cos(th2))/562949953421312 - (123928564092639*sin(th1))/72057594037927936 - (7184037743251309*cos(th1))/36893488147419103232 - (7330531551818703*cos(th4)*sin(th1))/36893488147419103232 - (5489399374888815*sin(th1)*sin(th4))/9223372036854775808 + (970893499285375*cos(th5)*(sin(th1)*sin(th4) - cos(th4)*(cos(th1)*sin(th2)*sin(th3) - cos(th1)*cos(th2)*cos(th3))))/9223372036854775808 - (5192391675427195*sin(th5)*(sin(th1)*sin(th4) - cos(th4)*(cos(th1)*sin(th2)*sin(th3) - cos(th1)*cos(th2)*cos(th3))))/72057594037927936 + (1663072680156839*sin(th6)*(cos(th4)*sin(th1) + sin(th4)*(cos(th1)*sin(th2)*sin(th3) - cos(th1)*cos(th2)*cos(th3))))/2305843009213693952 + (1663072680156839*cos(th6)*(cos(th5)*(sin(th1)*sin(th4) - cos(th4)*(cos(th1)*sin(th2)*sin(th3) - cos(th1)*cos(th2)*cos(th3))) - sin(th5)*(cos(th1)*cos(th2)*sin(th3) + cos(th1)*cos(th3)*sin(th2))))/2305843009213693952 + (5489399374888815*cos(th4)*(cos(th1)*sin(th2)*sin(th3) - cos(th1)*cos(th2)*cos(th3)))/9223372036854775808 - (5192391675427195*cos(th5)*(cos(th1)*cos(th2)*sin(th3) + cos(th1)*cos(th3)*sin(th2)))/72057594037927936 - (7330531551818703*sin(th4)*(cos(th1)*sin(th2)*sin(th3) - cos(th1)*cos(th2)*cos(th3)))/36893488147419103232 - (970893499285375*sin(th5)*(cos(th1)*cos(th2)*sin(th3) + cos(th1)*cos(th3)*sin(th2)))/9223372036854775808 - (1259578569946919*cos(th1)*sin(th2)*sin(th3))/18014398509481984 + (1259578569946919*cos(th1)*cos(th2)*cos(th3))/18014398509481984 - (5430591396830085*cos(th1)*cos(th2)*sin(th3))/18014398509481984 - (5430591396830085*cos(th1)*cos(th3)*sin(th2))/18014398509481984;
        - sin(th6)*(cos(th1)*cos(th4) - sin(th4)*(sin(th1)*sin(th2)*sin(th3) - cos(th2)*cos(th3)*sin(th1))) - cos(th6)*(cos(th5)*(cos(th1)*sin(th4) + cos(th4)*(sin(th1)*sin(th2)*sin(th3) - cos(th2)*cos(th3)*sin(th1))) + sin(th5)*(cos(th2)*sin(th1)*sin(th3) + cos(th3)*sin(th1)*sin(th2))), sin(th6)*(cos(th5)*(cos(th1)*sin(th4) + cos(th4)*(sin(th1)*sin(th2)*sin(th3) - cos(th2)*cos(th3)*sin(th1))) + sin(th5)*(cos(th2)*sin(th1)*sin(th3) + cos(th3)*sin(th1)*sin(th2))) - cos(th6)*(cos(th1)*cos(th4) - sin(th4)*(sin(th1)*sin(th2)*sin(th3) - cos(th2)*cos(th3)*sin(th1))), sin(th5)*(cos(th1)*sin(th4) + cos(th4)*(sin(th1)*sin(th2)*sin(th3) - cos(th2)*cos(th3)*sin(th1))) - cos(th5)*(cos(th2)*sin(th1)*sin(th3) + cos(th3)*sin(th1)*sin(th2)), (123928564092639*cos(th1))/72057594037927936 - (7184037743251309*sin(th1))/36893488147419103232 + (7330531551818703*cos(th1)*cos(th4))/36893488147419103232 + (151838081588107*cos(th2)*sin(th1))/562949953421312 + (5489399374888815*cos(th1)*sin(th4))/9223372036854775808 - (970893499285375*cos(th5)*(cos(th1)*sin(th4) + cos(th4)*(sin(th1)*sin(th2)*sin(th3) - cos(th2)*cos(th3)*sin(th1))))/9223372036854775808 + (5192391675427195*sin(th5)*(cos(th1)*sin(th4) + cos(th4)*(sin(th1)*sin(th2)*sin(th3) - cos(th2)*cos(th3)*sin(th1))))/72057594037927936 - (1663072680156839*sin(th6)*(cos(th1)*cos(th4) - sin(th4)*(sin(th1)*sin(th2)*sin(th3) - cos(th2)*cos(th3)*sin(th1))))/2305843009213693952 + (5489399374888815*cos(th4)*(sin(th1)*sin(th2)*sin(th3) - cos(th2)*cos(th3)*sin(th1)))/9223372036854775808 - (5192391675427195*cos(th5)*(cos(th2)*sin(th1)*sin(th3) + cos(th3)*sin(th1)*sin(th2)))/72057594037927936 - (1663072680156839*cos(th6)*(cos(th5)*(cos(th1)*sin(th4) + cos(th4)*(sin(th1)*sin(th2)*sin(th3) - cos(th2)*cos(th3)*sin(th1))) + sin(th5)*(cos(th2)*sin(th1)*sin(th3) + cos(th3)*sin(th1)*sin(th2))))/2305843009213693952 - (7330531551818703*sin(th4)*(sin(th1)*sin(th2)*sin(th3) - cos(th2)*cos(th3)*sin(th1)))/36893488147419103232 - (970893499285375*sin(th5)*(cos(th2)*sin(th1)*sin(th3) + cos(th3)*sin(th1)*sin(th2)))/9223372036854775808 - (5430591396830085*cos(th2)*sin(th1)*sin(th3))/18014398509481984 - (5430591396830085*cos(th3)*sin(th1)*sin(th2))/18014398509481984 - (1259578569946919*sin(th1)*sin(th2)*sin(th3))/18014398509481984 + (1259578569946919*cos(th2)*cos(th3)*sin(th1))/18014398509481984;
        sin(th4)*sin(th6)*(cos(th2)*sin(th3) + cos(th3)*sin(th2)) - cos(th6)*(sin(th5)*(cos(th2)*cos(th3) - sin(th2)*sin(th3)) + cos(th4)*cos(th5)*(cos(th2)*sin(th3) + cos(th3)*sin(th2))), sin(th6)*(sin(th5)*(cos(th2)*cos(th3) - sin(th2)*sin(th3)) + cos(th4)*cos(th5)*(cos(th2)*sin(th3) + cos(th3)*sin(th2))) + cos(th6)*sin(th4)*(cos(th2)*sin(th3) + cos(th3)*sin(th2)), cos(th4)*sin(th5)*(cos(th2)*sin(th3) + cos(th3)*sin(th2)) - cos(th5)*(cos(th2)*cos(th3) - sin(th2)*sin(th3)), (5430591396830085*sin(th2)*sin(th3))/18014398509481984 - (5430591396830085*cos(th2)*cos(th3))/18014398509481984 - (1259578569946919*cos(th2)*sin(th3))/18014398509481984 - (1259578569946919*cos(th3)*sin(th2))/18014398509481984 - (1663072680156839*cos(th6)*(sin(th5)*(cos(th2)*cos(th3) - sin(th2)*sin(th3)) + cos(th4)*cos(th5)*(cos(th2)*sin(th3) + cos(th3)*sin(th2))))/2305843009213693952 - (151838081588107*sin(th2))/562949953421312 + (5489399374888815*cos(th4)*(cos(th2)*sin(th3) + cos(th3)*sin(th2)))/9223372036854775808 - (5192391675427195*cos(th5)*(cos(th2)*cos(th3) - sin(th2)*sin(th3)))/72057594037927936 - (7330531551818703*sin(th4)*(cos(th2)*sin(th3) + cos(th3)*sin(th2)))/36893488147419103232 - (970893499285375*sin(th5)*(cos(th2)*cos(th3) - sin(th2)*sin(th3)))/9223372036854775808 - (970893499285375*cos(th4)*cos(th5)*(cos(th2)*sin(th3) + cos(th3)*sin(th2)))/9223372036854775808 + (5192391675427195*cos(th4)*sin(th5)*(cos(th2)*sin(th3) + cos(th3)*sin(th2)))/72057594037927936 + (1663072680156839*sin(th4)*sin(th6)*(cos(th2)*sin(th3) + cos(th3)*sin(th2)))/2305843009213693952 + 325695105792877/1125899906842624;
        0, 0, 0, 1];
    P1 = [ -0.000194724*cos(th1);
        -0.000194724*sin(th1);
        0.289275];
    P2 =[ 0.269719*cos(th1)*cos(th2) - 0.000812193*sin(th1) - 0.000194724*cos(th1);
        0.000812193*cos(th1) - 0.000194724*sin(th1) + 0.269719*cos(th2)*sin(th1);
        0.289275 - 0.269719*sin(th2)];
    P3 =[ 0.269719*cos(th1)*cos(th2) - 0.00171985*sin(th1) - 0.000194724*cos(th1) - 0.0699207*cos(th1)*sin(th2)*sin(th3) + 0.0699207*cos(th1)*cos(th2)*cos(th3);
        0.00171985*cos(th1) - 0.000194724*sin(th1) + 0.269719*cos(th2)*sin(th1) - 0.0699207*sin(th1)*sin(th2)*sin(th3) + 0.0699207*cos(th2)*cos(th3)*sin(th1);
        0.289275 - 0.0699207*cos(th2)*sin(th3) - 0.0699207*cos(th3)*sin(th2) - 0.269719*sin(th2)];
    
    P4 =[ 0.269719*cos(th1)*cos(th2) - 0.00171985*sin(th1) - 0.000194724*cos(th1) - 0.000595162*sin(th1)*sin(th4) - 0.0699207*cos(th1)*sin(th2)*sin(th3) + 0.0699207*cos(th1)*cos(th2)*cos(th3) - 0.301458*cos(th1)*cos(th2)*sin(th3) - 0.301458*cos(th1)*cos(th3)*sin(th2) - 0.000595162*cos(th1)*cos(th2)*cos(th3)*cos(th4) + 0.000595162*cos(th1)*cos(th4)*sin(th2)*sin(th3);
        0.00171985*cos(th1) - 0.000194724*sin(th1) + 0.269719*cos(th2)*sin(th1) + 0.000595162*cos(th1)*sin(th4) - 0.301458*cos(th2)*sin(th1)*sin(th3) - 0.301458*cos(th3)*sin(th1)*sin(th2) - 0.0699207*sin(th1)*sin(th2)*sin(th3) + 0.0699207*cos(th2)*cos(th3)*sin(th1) - 0.000595162*cos(th2)*cos(th3)*cos(th4)*sin(th1) + 0.000595162*cos(th4)*sin(th1)*sin(th2)*sin(th3);
        0.301458*sin(th2)*sin(th3) - 0.301458*cos(th2)*cos(th3) - 0.0699207*cos(th2)*sin(th3) - 0.0699207*cos(th3)*sin(th2) - 0.269719*sin(th2) + 0.000595162*cos(th2)*cos(th4)*sin(th3) + 0.000595162*cos(th3)*cos(th4)*sin(th2) + 0.289275];
    
    P5 = [ 0.269719*cos(th1)*cos(th2) - 0.00171985*sin(th1) - 0.000194724*cos(th1) - 0.000198694*cos(th4)*sin(th1) - 0.000595162*sin(th1)*sin(th4) - 0.0699207*cos(th1)*sin(th2)*sin(th3) + 0.000105264*cos(th5)*sin(th1)*sin(th4) + 0.0699207*cos(th1)*cos(th2)*cos(th3) - 0.301458*cos(th1)*cos(th2)*sin(th3) - 0.301458*cos(th1)*cos(th3)*sin(th2) - 0.000595162*cos(th1)*cos(th2)*cos(th3)*cos(th4) + 0.000198694*cos(th1)*cos(th2)*cos(th3)*sin(th4) + 0.000595162*cos(th1)*cos(th4)*sin(th2)*sin(th3) - 0.000105264*cos(th1)*cos(th2)*sin(th3)*sin(th5) - 0.000105264*cos(th1)*cos(th3)*sin(th2)*sin(th5) - 0.000198694*cos(th1)*sin(th2)*sin(th3)*sin(th4) + 0.000105264*cos(th1)*cos(th2)*cos(th3)*cos(th4)*cos(th5) - 0.000105264*cos(th1)*cos(th4)*cos(th5)*sin(th2)*sin(th3);
        0.00171985*cos(th1) - 0.000194724*sin(th1) + 0.000198694*cos(th1)*cos(th4) + 0.269719*cos(th2)*sin(th1) + 0.000595162*cos(th1)*sin(th4) - 0.301458*cos(th2)*sin(th1)*sin(th3) - 0.301458*cos(th3)*sin(th1)*sin(th2) - 0.0699207*sin(th1)*sin(th2)*sin(th3) + 0.0699207*cos(th2)*cos(th3)*sin(th1) - 0.000105264*cos(th1)*cos(th5)*sin(th4) - 0.000595162*cos(th2)*cos(th3)*cos(th4)*sin(th1) + 0.000198694*cos(th2)*cos(th3)*sin(th1)*sin(th4) + 0.000595162*cos(th4)*sin(th1)*sin(th2)*sin(th3) - 0.000105264*cos(th2)*sin(th1)*sin(th3)*sin(th5) - 0.000105264*cos(th3)*sin(th1)*sin(th2)*sin(th5) - 0.000198694*sin(th1)*sin(th2)*sin(th3)*sin(th4) + 0.000105264*cos(th2)*cos(th3)*cos(th4)*cos(th5)*sin(th1) - 0.000105264*cos(th4)*cos(th5)*sin(th1)*sin(th2)*sin(th3);
        0.301458*sin(th2)*sin(th3) - 0.301458*cos(th2)*cos(th3) - 0.0699207*cos(th2)*sin(th3) - 0.0699207*cos(th3)*sin(th2) - 0.269719*sin(th2) - 0.000198694*cos(th2)*sin(th3)*sin(th4) - 0.000198694*cos(th3)*sin(th2)*sin(th4) + 0.000105264*sin(th2)*sin(th3)*sin(th5) + 0.000595162*cos(th2)*cos(th4)*sin(th3) + 0.000595162*cos(th3)*cos(th4)*sin(th2) - 0.000105264*cos(th2)*cos(th3)*sin(th5) - 0.000105264*cos(th2)*cos(th4)*cos(th5)*sin(th3) - 0.000105264*cos(th3)*cos(th4)*cos(th5)*sin(th2) + 0.289275];
    
    P6 =[ 0.269719*cos(th1)*cos(th2) - 0.00171985*sin(th1) - 0.000194724*cos(th1) - 0.000198694*cos(th4)*sin(th1) - 0.000595162*sin(th1)*sin(th4) - 0.0699207*cos(th1)*sin(th2)*sin(th3) + 0.000105264*cos(th5)*sin(th1)*sin(th4) + 0.000721243*cos(th4)*sin(th1)*sin(th6) - 0.0720589*sin(th1)*sin(th4)*sin(th5) + 0.0699207*cos(th1)*cos(th2)*cos(th3) - 0.301458*cos(th1)*cos(th2)*sin(th3) - 0.301458*cos(th1)*cos(th3)*sin(th2) - 0.000595162*cos(th1)*cos(th2)*cos(th3)*cos(th4) + 0.000198694*cos(th1)*cos(th2)*cos(th3)*sin(th4) - 0.0720589*cos(th1)*cos(th2)*cos(th5)*sin(th3) - 0.0720589*cos(th1)*cos(th3)*cos(th5)*sin(th2) + 0.000595162*cos(th1)*cos(th4)*sin(th2)*sin(th3) - 0.000105264*cos(th1)*cos(th2)*sin(th3)*sin(th5) - 0.000105264*cos(th1)*cos(th3)*sin(th2)*sin(th5) + 0.000721243*cos(th5)*cos(th6)*sin(th1)*sin(th4) - 0.000198694*cos(th1)*sin(th2)*sin(th3)*sin(th4) + 0.000105264*cos(th1)*cos(th2)*cos(th3)*cos(th4)*cos(th5) - 0.0720589*cos(th1)*cos(th2)*cos(th3)*cos(th4)*sin(th5) - 0.000105264*cos(th1)*cos(th4)*cos(th5)*sin(th2)*sin(th3) - 0.000721243*cos(th1)*cos(th2)*cos(th3)*sin(th4)*sin(th6) - 0.000721243*cos(th1)*cos(th2)*cos(th6)*sin(th3)*sin(th5) - 0.000721243*cos(th1)*cos(th3)*cos(th6)*sin(th2)*sin(th5) + 0.0720589*cos(th1)*cos(th4)*sin(th2)*sin(th3)*sin(th5) + 0.000721243*cos(th1)*sin(th2)*sin(th3)*sin(th4)*sin(th6) + 0.000721243*cos(th1)*cos(th2)*cos(th3)*cos(th4)*cos(th5)*cos(th6) - 0.000721243*cos(th1)*cos(th4)*cos(th5)*cos(th6)*sin(th2)*sin(th3);
        0.00171985*cos(th1) - 0.000194724*sin(th1) + 0.000198694*cos(th1)*cos(th4) + 0.269719*cos(th2)*sin(th1) + 0.000595162*cos(th1)*sin(th4) - 0.301458*cos(th2)*sin(th1)*sin(th3) - 0.301458*cos(th3)*sin(th1)*sin(th2) + 0.0720589*cos(th1)*sin(th4)*sin(th5) - 0.0699207*sin(th1)*sin(th2)*sin(th3) + 0.0699207*cos(th2)*cos(th3)*sin(th1) - 0.000105264*cos(th1)*cos(th5)*sin(th4) - 0.000721243*cos(th1)*cos(th4)*sin(th6) - 0.000595162*cos(th2)*cos(th3)*cos(th4)*sin(th1) - 0.000721243*cos(th1)*cos(th5)*cos(th6)*sin(th4) + 0.000198694*cos(th2)*cos(th3)*sin(th1)*sin(th4) - 0.0720589*cos(th2)*cos(th5)*sin(th1)*sin(th3) - 0.0720589*cos(th3)*cos(th5)*sin(th1)*sin(th2) + 0.000595162*cos(th4)*sin(th1)*sin(th2)*sin(th3) - 0.000105264*cos(th2)*sin(th1)*sin(th3)*sin(th5) - 0.000105264*cos(th3)*sin(th1)*sin(th2)*sin(th5) - 0.000198694*sin(th1)*sin(th2)*sin(th3)*sin(th4) + 0.000105264*cos(th2)*cos(th3)*cos(th4)*cos(th5)*sin(th1) - 0.0720589*cos(th2)*cos(th3)*cos(th4)*sin(th1)*sin(th5) - 0.000105264*cos(th4)*cos(th5)*sin(th1)*sin(th2)*sin(th3) - 0.000721243*cos(th2)*cos(th3)*sin(th1)*sin(th4)*sin(th6) - 0.000721243*cos(th2)*cos(th6)*sin(th1)*sin(th3)*sin(th5) - 0.000721243*cos(th3)*cos(th6)*sin(th1)*sin(th2)*sin(th5) + 0.0720589*cos(th4)*sin(th1)*sin(th2)*sin(th3)*sin(th5) + 0.000721243*sin(th1)*sin(th2)*sin(th3)*sin(th4)*sin(th6) + 0.000721243*cos(th2)*cos(th3)*cos(th4)*cos(th5)*cos(th6)*sin(th1) - 0.000721243*cos(th4)*cos(th5)*cos(th6)*sin(th1)*sin(th2)*sin(th3);
        0.301458*sin(th2)*sin(th3) - 0.301458*cos(th2)*cos(th3) - 0.0699207*cos(th2)*sin(th3) - 0.0699207*cos(th3)*sin(th2) - 0.269719*sin(th2) - 0.000198694*cos(th2)*sin(th3)*sin(th4) - 0.000198694*cos(th3)*sin(th2)*sin(th4) + 0.0720589*cos(th5)*sin(th2)*sin(th3) + 0.000105264*sin(th2)*sin(th3)*sin(th5) - 0.0720589*cos(th2)*cos(th3)*cos(th5) + 0.000595162*cos(th2)*cos(th4)*sin(th3) + 0.000595162*cos(th3)*cos(th4)*sin(th2) - 0.000105264*cos(th2)*cos(th3)*sin(th5) - 0.000105264*cos(th2)*cos(th4)*cos(th5)*sin(th3) - 0.000105264*cos(th3)*cos(th4)*cos(th5)*sin(th2) - 0.000721243*cos(th2)*cos(th3)*cos(th6)*sin(th5) + 0.0720589*cos(th2)*cos(th4)*sin(th3)*sin(th5) + 0.0720589*cos(th3)*cos(th4)*sin(th2)*sin(th5) + 0.000721243*cos(th2)*sin(th3)*sin(th4)*sin(th6) + 0.000721243*cos(th3)*sin(th2)*sin(th4)*sin(th6) + 0.000721243*cos(th6)*sin(th2)*sin(th3)*sin(th5) - 0.000721243*cos(th2)*cos(th4)*cos(th5)*cos(th6)*sin(th3) - 0.000721243*cos(th3)*cos(th4)*cos(th5)*cos(th6)*sin(th2) + 0.289275];
    
end

if ~exist('axisHandel','var')
    figNum = figure(1);
    hold on;
    plot3([0;P1(1);P2(1);P3(1);P4(1);P5(1);P6(1)],...
        [0;P1(2);P2(2);P3(2);P4(2);P5(2);P6(2)],...
        [0;P1(3);P2(3);P3(3);P4(3);P5(3);P6(3)],'k','linewidth',2);
    axisHandel = gca;
    plot3([P6(1);P6(1)+T06(1,1)*.1],...
        [P6(2);P6(2)+T06(2,1)*.1],...
        [P6(3);P6(3)+T06(3,1)*.1],'r','Parent',axisHandel);
    plot3([P6(1);P6(1)+T06(1,2)*.1],...
        [P6(2);P6(2)+T06(2,2)*.1],...
        [P6(3);P6(3)+T06(3,2)*.1],'g','Parent',axisHandel);
    plot3([P6(1);P6(1)+T06(1,3)*.1],...
        [P6(2);P6(2)+T06(2,3)*.1],...
        [P6(3);P6(3)+T06(3,3)*.1],'b','Parent',axisHandel);
    hold off;
    axis([-.5 .5 -.5 .5 -.4 .75]);
    axisHandel = gca;
else
    plot3([0;P1(1);P2(1);P3(1);P4(1);P5(1);P6(1)],...
        [0;P1(2);P2(2);P3(2);P4(2);P5(2);P6(2)],...
        [0;P1(3);P2(3);P3(3);P4(3);P5(3);P6(3)],'k','linewidth',2,'Parent',axisHandel);
    hold on;
    plot3([P6(1);P6(1)+T06(1,1)*.1],...
        [P6(2);P6(2)+T06(2,1)*.1],...
        [P6(3);P6(3)+T06(3,1)*.1],'r','Parent',axisHandel);
    plot3([P6(1);P6(1)+T06(1,2)*.1],...
        [P6(2);P6(2)+T06(2,2)*.1],...
        [P6(3);P6(3)+T06(3,2)*.1],'g','Parent',axisHandel);
    plot3([P6(1);P6(1)+T06(1,3)*.1],...
        [P6(2);P6(2)+T06(2,3)*.1],...
        [P6(3);P6(3)+T06(3,3)*.1],'b','Parent',axisHandel);
    hold off;
    axis([-.75 .75 -.75 .75 -.4 .75]);
end

end